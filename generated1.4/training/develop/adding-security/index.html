<!DOCTYPE html>
<html>

<head>

  <meta name="description" content="A high-level introduction to the component parts of the Couchbase Mobile product." />
  <meta name="version" content="1.4" />
  <meta name="product" content="mobile" />
  

  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-MVPNN2');</script>
  <!-- End Google Tag Manager -->
  <meta charset="utf-8" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

  <link rel="shortcut icon" href="https://developer.couchbase.com/webfiles/1498186094252/images/icons/favicon/favicon.ico" type="image/x-icon">
  <link rel="icon" href="https://developer.couchbase.com/webfiles/1498186094252/images/icons/favicon/favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" sizes="57x57" href="https://developer.couchbase.com/webfiles/1498186094252/images/icons/favicon/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="https://developer.couchbase.com/webfiles/1498186094252/images/icons/favicon/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="https://developer.couchbase.com/webfiles/1498186094252/images/icons/favicon/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="https://developer.couchbase.com/webfiles/1498186094252/images/icons/favicon/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="https://developer.couchbase.com/webfiles/1498186094252/images/icons/favicon/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="https://developer.couchbase.com/webfiles/1498186094252/images/icons/favicon/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="https://developer.couchbase.com/webfiles/1498186094252/images/icons/favicon/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="https://developer.couchbase.com/webfiles/1498186094252/images/icons/favicon/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="https://developer.couchbase.com/webfiles/1498186094252/images/icons/favicon/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="/webfiles/1498186094252/images/icons/favicon/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="https://developer.couchbase.com/webfiles/1498186094252/images/icons/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="https://developer.couchbase.com/webfiles/1498186094252/images/icons/favicon/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="https://developer.couchbase.com/webfiles/1498186094252/images/icons/favicon/favicon-16x16.png">
  <link rel="manifest" href="https://developer.couchbase.com/webfiles/1498186094252/images/icons/favicon/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/webfiles/1498186094252/images/icons/favicon/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">

  <!--    _____________________________
  _______/ Support for legacy browsers \_______________________________________-->
  <!--[if lte IE 8]>
  <script type="text/javascript" charset="utf-8" src="/webfiles/1498186094252/js/thirdparty/vendor/html5shiv.js" />
  <script type="text/javascript" charset="utf-8" src="/webfiles/1498186094252/js/thirdparty/vendor/respond.js" />
  <![endif]-->
  <!--[if IE 9]>
  <script type="text/javascript" charset="utf-8" src="/webfiles/1498186094252/js/thirdparty/classList.js" />
  <![endif]-->
  <!--_________________________________________________________________________-->
  <script type="text/javascript" charset="utf-8" src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
  <script type="text/javascript" charset="utf-8" src="https://developer.couchbase.com/webfiles/1498186094252/js/thirdparty/vendor/jquery-migrate.js"></script>
  <script type="text/javascript" charset="utf-8" src="https://developer.couchbase.com/webfiles/1498186094252/js/thirdparty/vendor/slick.js"></script>
  <script type="text/javascript" charset="utf-8" src="https://developer.couchbase.com/webfiles/1498186094252/js/thirdparty/vendor/isotope.min.js"></script>
  <script type="text/javascript" charset="utf-8" src="https://developer.couchbase.com/webfiles/1498186094252/js/thirdparty/vendor/imagesloaded.min.js"></script>

  <meta name="apple-mobile-web-app-title" content="Couchbase">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="google-site-verification" content="1gPO0RaMzKyZJFpS-iyIEnPsWDztwZH0R3vG1VpSwvM" />

  <!-- LOCAL CSS Libs -->
  <link rel="stylesheet" href="https://developer.couchbase.com/webfiles/1498186094252/css/styles.css">

  <!-- Default canonical comes from the URL -->
  <link rel="canonical" href="http://developer.couchbase.com"/>
  <title>Couchbase</title>
  <link rel="stylesheet" href="https://developer.couchbase.com/binaries/content/assets/css/overrides.css">
</head>

<body>

<!-- Google Tag Manager -->
<noscript>
  <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MVPNN2" height="0"
          width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<!-- End Google Tag Manager -->
<script>
  var overrideJsPath = "/binaries/content/assets/js/overrides.js";
  $.ajax({
    url: overrideJsPath,
    type: 'HEAD',
    error: function () {
    },
    success: function () {
      // file exists
      $.getScript(overrideJsPath);
    }
  });
</script>
<!--    ________________
_______/ INCLUDE HEADER - BODY - FOOTER \____________________________________________________-->
<!-- begin - include ref= -->
<nav class="aux">
  <div>
  </div>
</nav>
<!-- Beginning of site.../jsp/base/header.jsp -->
<header id="global-header" class="global-header dev-portal">
  <div class="layout-wrapper">
    <div class="global-header__logo">
      <a href='http://www.couchbase.com'>Couchbase</a>
      <a href='index.html'>Developer</a>

    </div>

    <a data-modules="navigation,globalheadersearch"></a>
    <nav role="navigation" id="primary-navigation" class="primary-navigation">
      <button aria-controls="primary-navigation__wrapper"
              aria-pressed="false"
              class="primary-navigation__toggler"
              type="button">

        <span>Menu</span>
      </button>
      <div id="primary-navigation__wrapper"
           class="primary-navigation__wrapper"
           aria-expanded="false">

        <ul class="primary-navigation__items">
          <li class="primary-navigation__item ">

            <a href="https://developer.couchbase.com/documentation/server/current/introduction/intro.html">Server</a>
          </li>
          <li class="primary-navigation__item ">

            <a href="https://developer.couchbase.com/mobile">Mobile</a>
          </li>
          <li class="primary-navigation__item has-secondary-navigation">

            <a href="https://developer.couchbase.com/community">Community</a>
            <div class="secondary-navigation">
              <ul class="secondary-navigation__items">
                <li class="secondary-navigation__item">
                  <a href="https://developer.couchbase.com/open-source-projects">Open Source Projects</a>
                </li>
                <li class="secondary-navigation__item">
                  <a href="https://developer.couchbase.com/contribute">Contribute</a>
                </li>
                <li class="secondary-navigation__item">
                  <a href="http://www.couchbase.com/nosql-resources/events">Events</a>
                </li>
                <li class="secondary-navigation__item">
                  <a href="https://developer.couchbase.com/experts-and-champions">Experts &amp; Champions</a>
                </li>
                <li class="secondary-navigation__item">
                  <a href="http://forums.couchbase.com/">Forums</a>
                </li>
                <li class="secondary-navigation__item">
                  <a href="http://blog.couchbase.com">Blogs</a>
                </li>
                <li class="secondary-navigation__item">
                  <a href="https://developer.couchbase.com/support">Support</a>
                </li>
              </ul>
            </div>
          </li>
          <li class="primary-navigation__item has-secondary-navigation">

            <a href="https://developer.couchbase.com/guides-and-references">Site Map</a>
            <div class="secondary-navigation">
              <ul class="secondary-navigation__items">
                <li class="secondary-navigation__item">
                  <a href="https://developer.couchbase.com/guides-and-references#section-1">Couchbase Server</a>
                </li>
                <li class="secondary-navigation__item">
                  <a href="https://developer.couchbase.com/guides-and-references#section-2">Couchbase Mobile</a>
                </li>
                <li class="secondary-navigation__item">
                  <a href="https://developer.couchbase.com/guides-and-references#subsection-1-3">SDKs</a>
                </li>
                <li class="secondary-navigation__item">
                  <a href="https://developer.couchbase.com/guides-and-references#subsection-1-5">Connectors</a>
                </li>
                <li class="secondary-navigation__item">
                  <a href="https://developer.couchbase.com/documentation-archive">Documentation Archive</a>
                </li>
              </ul>
            </div>
          </li>
        </ul>
        <form id="global-header-search"
              autocomplete="off"
              class="global-header-search global-header-search--js"
              action="https://developer.couchbase.com/search"
              aria-expanded="false">
          <ul><!--
            ---><li>
            <label for="global-header-search__query">
              Search query
            </label>
            <input
                    type="search"
                    placeholder="Search"
                    name="q"
                    value=""
                    id="global-header-search__query">
          </li><!--
                ---><li>
            <button type="submit">
              <span>Search</span>
            </button>
          </li><!--
        ---></ul>
          <button aria-controls="global-header-search__items"
                  aria-pressed="false"
                  class="global-header-search__toggler"
                  type="button">
            <span>Search</span>
          </button><!--
        --->

          <div style="display: none" about="custom-search-fields">

            <input type="hidden"
                   name="cx"
                   value="017928787631531434501:3e7lwhjxsom" />
            <input type="hidden"
                   name="cof"
                   value="FORID:11" />
            <input type="hidden"
                   name="safe"
                   value="off" />
            <input type="hidden"
                   name="form_build_id"
                   value="form-RrbKDUhO3kB2MiqBdZHIQI9L4LFE7c3L_s87N2B9BZo" />
            <input type="hidden"
                   name="form_id"
                   value="google_cse_results_searchbox_form" />
            <input type="hidden"
                   name="siteurl"
                   value='developer.couchbase.com' />

          </div>
        </form>
      </div>
    </nav>
    <a class="global-header__download-button" href="https://developer.couchbase.com/downloads">
      Download
    </a>
  </div>
</header>

<div class="page-content">
  <div class="wrapper">
    <main id="global-content" class="global-content" role="main">

  <div id="page-template-attributes" data-template-id="" data-template-class="learn-support-sec article-tpl"></div>

  <!-- LEFTNAV and ARTICLE -->
  <section class="tpl-body">
    <div class="wrapper">
      <div class="cols">
        <aside class="col one-fifth section-nav left-rail">
          <nav role="navigation" aria-label="Secondary" style="width: 100%;">
            <div class="toc collapsible" style="display: block;">
              



<!-- Used in the left nav to find the relative URL -->




<nav style="width: 100%;" role="navigation" aria-label="Secondary" class="toc collapsible">
  <ul class="main collapsed">
    
      <li class="isexpanded open ">
      
        
          <a href="../../../whatsnew.html">What's new</a>
        
      
      
      </li>
    
      <li class=" ishidden">
      
        <a href="#" class="static">Hidden Files For Redirects</a>
      
      
        <ul>
          
          <li class=" ">
            
              
                <a href="../../../guides/sync-gateway/views/index.html">Creating and querying a View</a>
              
            
            
          </li>
          
        </ul>
      
      </li>
    
      <li class="isexpanded open ">
      
        
          <a href="../../../installation/index.html">Getting Started</a>
        
      
      
        <ul>
          
          <li class=" ">
            
              
                <a href="../../../installation/ios/index.html">iOS/tvOS/macOS</a>
              
            
            
          </li>
          
          <li class=" ">
            
              
                <a href="../../../installation/android/index.html">Android</a>
              
            
            
          </li>
          
          <li class=" ">
            
              
                <a href="../../../installation/net/index.html">.NET</a>
              
            
            
          </li>
          
          <li class=" ">
            
              
                <a href="../../../installation/xamarin/index.html">Xamarin</a>
              
            
            
          </li>
          
          <li class=" ">
            
              
                <a href="../../../installation/java/index.html">Java</a>
              
            
            
          </li>
          
          <li class=" ">
            
              
                <a href="../../../installation/phonegap/index.html">PhoneGap</a>
              
            
            
          </li>
          
          <li class=" ">
            
              
                <a href="../../../installation/sync-gateway/index.html">Sync Gateway</a>
              
            
            
          </li>
          
        </ul>
      
      </li>
    
      <li class=" ">
      
        
          <a href="../../../training/index.html">Tutorial</a>
        
      
      
        <ul>
          
          <li class=" ">
            
              <a href="#" class="static">Design</a>
            
            
            <ul>
              
              <li class=" ">
                
                  
                    <a href="../../../training/design/data-modeling/index.html">Data Modeling</a>
                  
                
                
              </li>
              
              <li class=" ">
                
                  
                    <a href="../../../training/design/security/index.html">Access Control</a>
                  
                
                
              </li>
              
            </ul>
            
          </li>
          
          <li class=" ">
            
              <a href="#" class="static">Develop</a>
            
            
            <ul>
              
              <li class=" ">
                
                  
                    <a href="../../../training/develop/create-database/index.html">Create a Database</a>
                  
                
                
              </li>
              
              <li class=" ">
                
                  
                    <a href="../../../training/develop/using-the-database/index.html">Using the Database</a>
                  
                
                
              </li>
              
              <li class=" ">
                
                  
                    <a href="../../../training/develop/adding-synchronization/index.html">Adding Sync</a>
                  
                
                
              </li>
              
              <li class=" ">
                
                  
                    <a class="selected" href="../../../training/develop/adding-security/index.html">Adding Security</a>
                  
                
                
              </li>
              
              <li class=" ">
                
                  
                    <a href="../../../training/develop/integration/index.html">Integration</a>
                  
                
                
              </li>
              
            </ul>
            
          </li>
          
          <li class=" ">
            
              <a href="#" class="static">Deploy</a>
            
            
            <ul>
              
              <li class=" ">
                
                  
                    <a href="../../../training/deploy/install/index.html">Install</a>
                  
                
                
              </li>
              
              <li class=" ">
                
                  
                    <a href="../../../training/deploy/upgrade/index.html">Upgrade</a>
                  
                
                
              </li>
              
              <li class=" ">
                
                  
                    <a href="../../../training/deploy/scale/index.html">Scale</a>
                  
                
                
              </li>
              
            </ul>
            
          </li>
          
        </ul>
      
      </li>
    
      <li class="isexpanded open ">
      
        
          <a href="../../../guides/index.html">Guides</a>
        
      
      
        <ul>
          
          <li class=" ">
            
              
                <a href="../../../guides/couchbase-lite/native-api/data-modeling/index.html">Data Modeling</a>
              
            
            
          </li>
          
          <li class=" ">
            
              
                <a href="../../../guides/couchbase-lite/index.html">Couchbase Lite</a>
              
            
            
            <ul>
              
              <li class=" ">
                
                  
                    <a href="../../../guides/couchbase-lite/native-api/index.html">Native API</a>
                  
                
                
                <ul>
                  
                  <li class=" ">
                    
                      
                      <a href="../../../guides/couchbase-lite/native-api/manager/index.html">Manager</a>
                      
                    
                    
                  </li>
                  
                  <li class=" ">
                    
                      
                      <a href="../../../guides/couchbase-lite/native-api/database/index.html">Database</a>
                      
                    
                    
                  </li>
                  
                  <li class=" ">
                    
                      
                      <a href="../../../guides/couchbase-lite/native-api/document/index.html">Document</a>
                      
                    
                    
                  </li>
                  
                  <li class=" ">
                    
                      
                      <a href="../../../guides/couchbase-lite/native-api/revision/index.html">Revision</a>
                      
                    
                    
                  </li>
                  
                  <li class=" ">
                    
                      
                      <a href="../../../guides/couchbase-lite/native-api/attachment/index.html">Attachment</a>
                      
                    
                    
                  </li>
                  
                  <li class=" ">
                    
                      
                      <a href="../../../guides/couchbase-lite/native-api/view/index.html">View</a>
                      
                    
                    
                  </li>
                  
                  <li class=" ">
                    
                      
                      <a href="../../../guides/couchbase-lite/native-api/query/index.html">Query</a>
                      
                    
                    
                  </li>
                  
                  <li class=" ">
                    
                      
                      <a href="../../../guides/couchbase-lite/native-api/replication/index.html">Replication</a>
                      
                    
                    
                  </li>
                  
                  <li class=" ">
                    
                      
                      <a href="../../../guides/couchbase-lite/native-api/peer-to-peer/index.html">Peer-to-peer</a>
                      
                    
                    
                  </li>
                  
                  <li class=" ">
                    
                      
                      <a href="../../../guides/couchbase-lite/native-api/model/index.html">Model (iOS only)</a>
                      
                    
                    
                  </li>
                  
                </ul>
                
              </li>
              
              <li class=" ">
                
                  
                    <a href="../../../guides/couchbase-lite/tech-notes/index.html">Technical Notes</a>
                  
                
                
                <ul>
                  
                  <li class=" ">
                    
                      
                      <a href="../../../guides/couchbase-lite/tech-notes/cbl-encryption/index.html">Encrypting Databases</a>
                      
                    
                    
                  </li>
                  
                </ul>
                
              </li>
              
            </ul>
            
          </li>
          
          <li class=" ">
            
              
                <a href="../../../guides/sync-gateway/index.html">Sync Gateway</a>
              
            
            
            <ul>
              
              <li class=" ">
                
                  
                    <a href="../../../guides/sync-gateway/config-properties/index.html">Configuration file</a>
                  
                
                
              </li>
              
              <li class=" ">
                
                  
                    <a href="../../../guides/sync-gateway/command-line-options/index.html">Command line options</a>
                  
                
                
              </li>
              
              <li class=" ">
                
                  
                    <a href="../../../guides/sync-gateway/authorizing-users/index.html">Authorizing Users</a>
                  
                
                
              </li>
              
              <li class=" ">
                
                  
                    <a href="../../../guides/sync-gateway/channels/index.html">Data Routing</a>
                  
                
                
              </li>
              
              <li class=" ">
                
                  
                    <a href="../../../guides/sync-gateway/sync-function-api-guide/index.html">Sync Function API</a>
                  
                
                
              </li>
              
              <li class=" ">
                
                  
                    <a href="../../../guides/sync-gateway/server-integration/index.html">Webhooks and changes feed</a>
                  
                
                
              </li>
              
              <li class=" ">
                
                  
                    <a href="../../../guides/sync-gateway/deployment/index.html">Deployment considerations</a>
                  
                
                
              </li>
              
              <li class=" ">
                
                  
                    <a href="../../../guides/sync-gateway/upgrade/index.html">Upgrade</a>
                  
                
                
              </li>
              
              <li class=" ">
                
                  
                    <a href="../../../guides/sync-gateway/nginx/index.html">Load Balancer</a>
                  
                
                
              </li>
              
              <li class=" ">
                
                  
                    <a href="../../../guides/sync-gateway/database-offline/index.html">Taking databases offline and online</a>
                  
                
                
              </li>
              
              <li class=" ">
                
                  
                    <a href="../../../guides/sync-gateway/os-level-tuning/index.html">OS Level Tuning</a>
                  
                
                
              </li>
              
              <li class=" ">
                
                  
                    <a href="../../../guides/sync-gateway/resolving-conflicts/index.html">Resolving Conflicts</a>
                  
                
                
              </li>
              
              <li class=" ">
                
                  
                    <a href="../../../guides/sync-gateway/integrating-external-stores/index.html">Integrating External Stores</a>
                  
                
                
              </li>
              
              <li class=" ">
                
                  
                    <a href="../../../guides/sync-gateway/running-replications/index.html">Running replications</a>
                  
                
                
              </li>
              
              <li class=" ">
                
                  
                    <a href="../../../guides/sync-gateway/rest-api-client/index.html">REST API Client</a>
                  
                
                
              </li>
              
              <li class=" ">
                
                  
                    <a href="../../../guides/sync-gateway/sgcollect-info/index.html">SGCollect Info</a>
                  
                
                
              </li>
              
              <li class=" ">
                
                  
                    <a href="../../../guides/sync-gateway/configuring-ssl/index.html">Configuring SSL</a>
                  
                
                
              </li>
              
              <li class=" ">
                
                  
                    <a href="../../../guides/sync-gateway/bucket-shadowing/index.html">Bucket Shadowing</a>
                  
                
                
              </li>
              
              <li class=" ">
                
                  
                    <a href="../../../guides/sync-gateway/accelerator.html">Accelerator</a>
                  
                
                
              </li>
              
            </ul>
            
          </li>
          
          <li class=" ">
            
              
                <a href="../../../guides/authentication/index.html">Authentication</a>
              
            
            
            <ul>
              
              <li class=" ">
                
                  
                    <a href="../../../guides/authentication/basic-authentication/index.html">Basic Authentication</a>
                  
                
                
              </li>
              
              <li class=" ">
                
                  
                    <a href="../../../guides/authentication/openid/index.html">OpenID Connect</a>
                  
                
                
                <ul>
                  
                  <li class=" ">
                    
                      
                      <a href="../../../guides/authentication/openid/configuration-options/index.html">Configuration Options</a>
                      
                    
                    
                  </li>
                  
                  <li class=" ">
                    
                      
                      <a href="../../../guides/authentication/openid/advanced-topics/index.html">Advanced Topics</a>
                      
                    
                    
                  </li>
                  
                  <li class=" ">
                    
                      
                      <a href="../../../guides/authentication/openid/google/index.html">How-To: Google</a>
                      
                    
                    
                  </li>
                  
                  <li class=" ">
                    
                      
                      <a href="../../../guides/authentication/openid/active-directory/index.html">How-To: Active Directory</a>
                      
                    
                    
                  </li>
                  
                </ul>
                
              </li>
              
              <li class=" ">
                
                  
                    <a href="../../../guides/authentication/custom-authentication/index.html">Custom Authentication</a>
                  
                
                
              </li>
              
              <li class=" ">
                
                  
                    <a href="../../../guides/authentication/static-providers/index.html">Static Providers</a>
                  
                
                
              </li>
              
            </ul>
            
          </li>
          
        </ul>
      
      </li>
    
      <li class="isexpanded open ">
      
        
          <a href="../../../references/index.html">API References</a>
        
      
      
        <ul>
          
          <li class=" ">
            
              
                <a href="../../../references/couchbase-lite/index.html">Couchbase Lite</a>
              
            
            
            <ul>
              
              <li class=" ">
                
                  
                    <a href="../../../references/couchbase-lite/couchbase-lite/index.html">Native API</a>
                  
                
                
                <ul>
                  
                  <li class=" ">
                    
                      
                      <a href="../../../references/couchbase-lite/couchbase-lite/manager/index.html">Manager</a>
                      
                    
                    
                    <ul>
                      
                      <li class=" ">
                        
                          
                          <a href="../../../references/couchbase-lite/couchbase-lite/manager/manager/index.html">Manager</a>
                          
                        
                        
                      </li>
                      
                      <li class=" ">
                        
                          
                          <a href="../../../references/couchbase-lite/couchbase-lite/manager/manager-options/index.html">ManagerOptions</a>
                          
                        
                        
                      </li>
                      
                      <li class=" ">
                        
                          
                          <a href="../../../references/couchbase-lite/couchbase-lite/manager/database-options/index.html">DatabaseOptions</a>
                          
                        
                        
                      </li>
                      
                    </ul>
                    
                  </li>
                  
                  <li class=" ">
                    
                      
                      <a href="../../../references/couchbase-lite/couchbase-lite/database/index.html">Database</a>
                      
                    
                    
                    <ul>
                      
                      <li class=" ">
                        
                          
                          <a href="../../../references/couchbase-lite/couchbase-lite/database/database/index.html">Database</a>
                          
                        
                        
                      </li>
                      
                      <li class=" ">
                        
                          
                          <a href="../../../references/couchbase-lite/couchbase-lite/database/validation-context/index.html">ValidationContext</a>
                          
                        
                        
                      </li>
                      
                    </ul>
                    
                  </li>
                  
                  <li class=" ">
                    
                      
                      <a href="../../../references/couchbase-lite/couchbase-lite/document/index.html">Document</a>
                      
                    
                    
                    <ul>
                      
                      <li class=" ">
                        
                          
                          <a href="../../../references/couchbase-lite/couchbase-lite/document/document/index.html">Document</a>
                          
                        
                        
                      </li>
                      
                      <li class=" ">
                        
                          
                          <a href="../../../references/couchbase-lite/couchbase-lite/document/document-change/index.html">Document Change</a>
                          
                        
                        
                      </li>
                      
                    </ul>
                    
                  </li>
                  
                  <li class=" ">
                    
                      
                      <a href="../../../references/couchbase-lite/couchbase-lite/revision/index.html">Revision</a>
                      
                    
                    
                    <ul>
                      
                      <li class=" ">
                        
                          
                          <a href="../../../references/couchbase-lite/couchbase-lite/revision/revision/index.html">Revision</a>
                          
                        
                        
                      </li>
                      
                      <li class=" ">
                        
                          
                          <a href="../../../references/couchbase-lite/couchbase-lite/revision/saved-revision/index.html">Saved Revision</a>
                          
                        
                        
                      </li>
                      
                      <li class=" ">
                        
                          
                          <a href="../../../references/couchbase-lite/couchbase-lite/revision/unsaved-revision/index.html">Unsaved Revision</a>
                          
                        
                        
                      </li>
                      
                    </ul>
                    
                  </li>
                  
                  <li class=" ">
                    
                      
                      <a href="../../../references/couchbase-lite/couchbase-lite/attachment/index.html">Attachment</a>
                      
                    
                    
                    <ul>
                      
                      <li class=" ">
                        
                          
                          <a href="../../../references/couchbase-lite/couchbase-lite/attachment/attachment/index.html">Attachment</a>
                          
                        
                        
                      </li>
                      
                    </ul>
                    
                  </li>
                  
                  <li class=" ">
                    
                      
                      <a href="../../../references/couchbase-lite/couchbase-lite/view/index.html">View</a>
                      
                    
                    
                    <ul>
                      
                      <li class=" ">
                        
                          
                          <a href="../../../references/couchbase-lite/couchbase-lite/view/view/index.html">View</a>
                          
                        
                        
                      </li>
                      
                      <li class=" ">
                        
                          
                          <a href="../../../references/couchbase-lite/couchbase-lite/view/view-compiler/index.html">View Compiler</a>
                          
                        
                        
                      </li>
                      
                    </ul>
                    
                  </li>
                  
                  <li class=" ">
                    
                      
                      <a href="../../../references/couchbase-lite/couchbase-lite/query/index.html">Query</a>
                      
                    
                    
                    <ul>
                      
                      <li class=" ">
                        
                          
                          <a href="../../../references/couchbase-lite/couchbase-lite/query/query/index.html">Query</a>
                          
                        
                        
                      </li>
                      
                      <li class=" ">
                        
                          
                          <a href="../../../references/couchbase-lite/couchbase-lite/query/live-query/index.html">Live Query</a>
                          
                        
                        
                      </li>
                      
                      <li class=" ">
                        
                          
                          <a href="../../../references/couchbase-lite/couchbase-lite/query/query-enumerator/index.html">QueryEnumerator</a>
                          
                        
                        
                      </li>
                      
                      <li class=" ">
                        
                          
                          <a href="../../../references/couchbase-lite/couchbase-lite/query/query-row/index.html">QueryRow</a>
                          
                        
                        
                      </li>
                      
                    </ul>
                    
                  </li>
                  
                  <li class=" ">
                    
                      
                      <a href="../../../references/couchbase-lite/couchbase-lite/replication/index.html">Replication</a>
                      
                    
                    
                    <ul>
                      
                      <li class=" ">
                        
                          
                          <a href="../../../references/couchbase-lite/couchbase-lite/replication/replication/index.html">Replication</a>
                          
                        
                        
                      </li>
                      
                      <li class=" ">
                        
                          
                          <a href="../../../references/couchbase-lite/couchbase-lite/replication/authenticator/index.html">Authenticator</a>
                          
                        
                        
                      </li>
                      
                      <li class=" ">
                        
                          
                          <a href="../../../references/couchbase-lite/couchbase-lite/replication/authenticator-factory/index.html">AuthenticatorFactory</a>
                          
                        
                        
                      </li>
                      
                    </ul>
                    
                  </li>
                  
                </ul>
                
              </li>
              
              <li class=" ">
                
                  
                    <a href="../../../references/couchbase-lite/rest-api/index.html">REST API</a>
                  
                
                
              </li>
              
              <li class=" ">
                
                  
                    <a href="../../../references/couchbase-lite/release-notes/index.html">Release notes</a>
                  
                
                
                <ul>
                  
                  <li class=" ">
                    
                      
                      <a href="../../../references/couchbase-lite/release-notes/iOS/index.html">iOS</a>
                      
                    
                    
                  </li>
                  
                  <li class=" ">
                    
                      
                      <a href="../../../references/couchbase-lite/release-notes/Java/index.html">Java</a>
                      
                    
                    
                  </li>
                  
                  <li class=" ">
                    
                      
                      <a href="../../../references/couchbase-lite/release-notes/Dot-Net/index.html">.NET</a>
                      
                    
                    
                  </li>
                  
                </ul>
                
              </li>
              
            </ul>
            
          </li>
          
          <li class=" ">
            
              
                <a href="../../../references/sync-gateway/index.html">Sync Gateway</a>
              
            
            
            <ul>
              
              <li class=" ">
                
                  
                    <a href="../../../references/sync-gateway/rest-api/index.html">Public REST API</a>
                  
                
                
              </li>
              
              <li class=" ">
                
                  
                    <a href="../../../references/sync-gateway/admin-rest-api/index.html">Admin REST API</a>
                  
                
                
              </li>
              
              <li class=" ">
                
                  
                    <a href="../../../references/sync-gateway/release-notes/index.html">Release notes</a>
                  
                
                
              </li>
              
            </ul>
            
          </li>
          
        </ul>
      
      </li>
    
  </ul>
</nav>
            </div>
          </nav>
        </aside>
        <div class="col four-fifths article">
          <div class="story">
            <div class="body">
              
              
              
              <!-- Do not import the overridden styles on swagger ui pages -->
              
              <link rel="stylesheet" type="text/css" href="https://couchbase-docs.s3.amazonaws.com/mobile/assets/styles.css">
              
              
              
              <a class="edit-page-link" href="https://github.com/couchbaselabs/couchbase-mobile-portal/tree/master/md-docs/_1x/training/develop/adding-security/06-adding-security.md" target="_blank">Edit on GitHub</a>
              

              <div class="inner-content">
                <!-- Style API ref links -->
                <style>
                  a > code {
                    text-decoration: underline;
                    color: #0099e5;
                    background: #f5f7f7;
                    border-radius: 5px;
                    padding: 3px 6px;
                    margin: 0 1px;
                  }
                </style>
                <!-- Platform tabs -->
                <!-- TODO: Make visible when ready to show multi-platform training -->
                <div class="toggler">
                  <style>
                    .toggler a {
                      display: inline-block;
                      padding: 3px 20px;
                      margin: 2px;
                      border: 1px solid #00739c;
                      border-radius: 3px;
                      text-decoration: none !important;
                    }
                    .display-platform-ios .toggler .button-ios,
                    .display-platform-android .toggler .button-android,
                    .display-platform-rn .toggler .button-rn,
                    .display-platform-wpf .toggler .button-wpf,
                    .display-platform-csharp .toggler .button-csharp,
                    .display-platform-xam .toggler .button-xam,
                    .display-platform-swift .toggler .button-swift,
                    .display-platform-objc .toggler .button-objc,
                    .display-platform-java .toggler .button-java {
                      background-color: #00739c;
                      color: white;
                    }

                    block { display: none; }

                    .display-platform-ios .ios,
                    .display-platform-android .android,
                    .display-platform-rn .rn,
                    .display-platform-net .net,
                    .display-platform-csharp .csharp,
                    .display-platform-wpf .wpf,
                    .display-platform-xam .xam,
                    .display-platform-all .all,
                    .display-platform-swift .swift,
                    .display-platform-objc .objc,
                    .display-platform-java .java {
                      display: block;
                    }
                    .inner-content .inline:not(.tab-nav) {
                      display: none;
                    }
                    /* Must change the display mode for striped method names.
                       This works with the StripingTag Jekyll plugin. */
                    .display-platform-ios .ios.inline,
                    .display-platform-android .android.inline,
                    .display-platform-net .net.inline,
                    .display-platform-csharp .csharp.inline,
                    .display-platform-swift .swift.inline,
                    .display-platform-objc .objc.inline,
                    .display-platform-java .java.inline {
                      display: inline;
                    }
                  </style>
                  <div id="platform-tabs" class="hide">
                    <span>Platform:</span>
                    
                    <a href="javascript:void(0);" class="button-ios" onclick="display('platform', 'ios')">iOS</a>
                    <a href="javascript:void(0);" class="button-android" onclick="display('platform', 'android')">Android</a>
                    <a href="javascript:void(0);" class="button-wpf" onclick="display('platform', 'wpf')">WPF</a>
                    
                  </div>
                </div>
                <!-- SDK buttons -->
                <div id="swagger-libs" style="display: none;">
                  <span>Sync Gateway Public REST API:</span>
                  <a href="javascript:void(0);" class="button" onclick="getSDK('java', 'public')">Java</a>
                  <a href="javascript:void(0);" class="button" onclick="getSDK('csharp', 'public')">C#</a>
                  <a href="javascript:void(0);" class="button" onclick="getSDK('go', 'public')">Go</a>
                  <a href="javascript:void(0);" class="button" onclick="getSDK('python', 'public')">Python</a>
                  <br>
                  <span>Sync Gateway Admin REST API:</span>
                  <a href="javascript:void(0);" class="button" onclick="getSDK('go', 'admin')">Go</a>
                  <a href="javascript:void(0);" class="button" onclick="getSDK('python', 'admin')">Python</a>
                  <br>
                  <span>Couchbase Lite REST API:</span>
                  <a href="javascript:void(0);" class="button" onclick="getSDK('java', 'lite')">Java</a>
                  <a href="javascript:void(0);" class="button" onclick="getSDK('csharp', 'lite')">C#</a>
                  <a href="javascript:void(0);" class="button" onclick="getSDK('swift', 'lite')">Swift</a>
                  <a href="javascript:void(0);" class="button" onclick="getSDK('python', 'lite')">Python</a>
                </div>
                <!-- Markdown content -->
                <p>In this lesson you’ll learn how to add security to your Couchbase Mobile application. You’ll implement authentication and define access control, data validation, and access grant policies.</p>

<p><block class="ios" /></p>
<h4><a class="anchor instructions" name="requirements"></a>Requirements<a class="hash-link instructions" href="#requirements"><svg aria-hidden="true" class="octicon octicon-link" height="20" version="1.1" viewBox="0 -3 20 20" width="20"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a></h4>
<ul>
<li>Xcode 8 (Swift 3)</li>
</ul>
<h4><a class="anchor instructions" name="getting-started"></a>Getting Started<a class="hash-link instructions" href="#getting-started"><svg aria-hidden="true" class="octicon octicon-link" height="20" version="1.1" viewBox="0 -3 20 20" width="20"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a></h4>
<p>Download the project below.</p>

<div class="buttons-unit downloads">
  <a href="https://cl.ly/3f263e2O0837/project.zip" class="button" id="project">
    <img src="img/download-xcode.png">
  </a>
</div>

<p>Unzip the file and install Couchbase Lite using the install script.</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span><span class="nb">cd </span>xcode-project
<span class="nv">$ </span>./install.sh
</code></pre></div>
<p>Open <strong>Todo.xcodeproj</strong> in Xcode. Then build &amp; run the project.</p>

<p><block class="net" /></p>
<h4><a class="anchor instructions" name="requirements"></a>Requirements<a class="hash-link instructions" href="#requirements"><svg aria-hidden="true" class="octicon octicon-link" height="20" version="1.1" viewBox="0 -3 20 20" width="20"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a></h4>
<ul>
<li>Visual Studio 2015+ (Windows) or Xamarin Studio 6+ (OS X)</li>
</ul>
<h4><a class="anchor instructions" name="getting-started"></a>Getting Started<a class="hash-link instructions" href="#getting-started"><svg aria-hidden="true" class="octicon octicon-link" height="20" version="1.1" viewBox="0 -3 20 20" width="20"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a></h4>
<p>Download the project below.</p>

<div class="buttons-unit downloads">
  <a href="https://cl.ly/3f263e2O0837/project.zip" class="button" id="project">
    <img src="img/download-vs.png">
  </a>
</div>

<p><block class="android" /></p>
<h4><a class="anchor instructions" name="requirements"></a>Requirements<a class="hash-link instructions" href="#requirements"><svg aria-hidden="true" class="octicon octicon-link" height="20" version="1.1" viewBox="0 -3 20 20" width="20"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a></h4>
<ul>
<li>Android Studio 2.2</li>
<li>Android SDK 24</li>
<li>Android Build Tools 24.0.3</li>
<li>JDK 8</li>
<li>⚠️ Docker and x86 Android emulators are <a href="http://stackoverflow.com/questions/37397810/android-studio-unable-to-run-avd">not compatible</a> (i.e cannot run simultaneously on the same machine). Make sure Docker isn&#39;t running in the background when deploying the application to an x86 Android emulator.</li>
</ul>
<h4><a class="anchor instructions" name="getting-started"></a>Getting Started<a class="hash-link instructions" href="#getting-started"><svg aria-hidden="true" class="octicon octicon-link" height="20" version="1.1" viewBox="0 -3 20 20" width="20"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a></h4>
<p>Download the project below.</p>

<div class="buttons-unit downloads">
  <a href="https://cl.ly/3f263e2O0837/project.zip" class="button" id="project">
    <img src="img/download-android.png">
  </a>
</div>

<p><block class="all" /></p>
<h2><a class="anchor instructions" name="user-authentication"></a>User Authentication<a class="hash-link instructions" href="#user-authentication"><svg aria-hidden="true" class="octicon octicon-link" height="20" version="1.1" viewBox="0 -3 20 20" width="20"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a></h2><h3><a class="anchor instructions" name="install-sync-gateway"></a>Install Sync Gateway<a class="hash-link instructions" href="#install-sync-gateway"><svg aria-hidden="true" class="octicon octicon-link" height="20" version="1.1" viewBox="0 -3 20 20" width="20"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a></h3>
<p>Users are created with a name/password on Sync Gateway which can then be used on the Couchbase Lite replicator to authenticate as a given user. You can create users by hardcoding the user&#39;s name/password in the configuration file. Create a new file called <strong>sync-gateway-config.json</strong> with the following.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="p">{</span>
  <span class="s2">"log"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"HTTP"</span><span class="p">,</span> <span class="s2">"Auth"</span><span class="p">],</span>
  <span class="s2">"databases"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"todo"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"server"</span><span class="p">:</span> <span class="s2">"walrus:"</span><span class="p">,</span>
      <span class="s2">"users"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"user1"</span><span class="p">:</span> <span class="p">{</span><span class="s2">"password"</span><span class="p">:</span> <span class="s2">"pass"</span><span class="p">,</span> <span class="s2">"admin_channels"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"user1"</span><span class="p">]},</span>
        <span class="s2">"user2"</span><span class="p">:</span> <span class="p">{</span><span class="s2">"password"</span><span class="p">:</span> <span class="s2">"pass"</span><span class="p">,</span> <span class="s2">"admin_channels"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"user2"</span><span class="p">]},</span>
        <span class="s2">"mod"</span><span class="p">:</span> <span class="p">{</span><span class="s2">"password"</span><span class="p">:</span> <span class="s2">"pass"</span><span class="p">,</span> <span class="s2">"admin_roles"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"moderator"</span><span class="p">]},</span>
        <span class="s2">"admin"</span><span class="p">:</span> <span class="p">{</span><span class="s2">"password"</span><span class="p">:</span> <span class="s2">"pass"</span><span class="p">,</span> <span class="s2">"admin_roles"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"admin"</span><span class="p">]}</span>
      <span class="p">},</span>
      <span class="s2">"roles"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"moderator"</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s2">"admin"</span><span class="p">:</span> <span class="p">{}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><h4><a class="anchor instructions" name="try-it-out"></a>Try it out<a class="hash-link instructions" href="#try-it-out"><svg aria-hidden="true" class="octicon octicon-link" height="20" version="1.1" viewBox="0 -3 20 20" width="20"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a></h4>
<ol>
<li><a href="http://www.couchbase.com/nosql-databases/downloads#couchbase-mobile">Download Sync Gateway</a></li>
<li>Unzip the file and locate the executable at <strong>~/Downloads/couchbase-sync-gateway/bin/sync_gateway</strong>.</li>
<li><p>Start it from the command-line with the config file.</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>/path/to/sync_gateway sync-gateway-config.json
</code></pre></div><div class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="nb">PS</span><span class="o">&gt;</span> &amp; <span class="s1">'C:\Program Files (x86)\Couchbase\sync_gateway.exe'</span> sync-gateway-config.json
</code></pre></div>
<blockquote>
<p><strong>Note:</strong> The Sync Gateway service might be running on Windows which will prevent this command from succeeding with the message &#39;FATAL: Failed to start HTTP server on 127.0.0.1:4985: listen tcp 127.0.0.1:4985: bind: Only one usage of each socket address (protocol/network address/port) is normally permitted.&#39;  To get around this, stop the &#39;Couchbase Sync Gateway&#39; service in &#39;services.msc&#39;.</p>
</blockquote></li>
<li><p>Two users are now visible at <a href="http://localhost:4985/_admin/db/todo/users">http://localhost:4985/_admin/db/todo/users</a>.</p></li>
</ol>
<h3><a class="anchor instructions" name="replications-with-authentication"></a>Replications with Authentication<a class="hash-link instructions" href="#replications-with-authentication"><svg aria-hidden="true" class="octicon octicon-link" height="20" version="1.1" viewBox="0 -3 20 20" width="20"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a></h3>
<p>With Sync Gateway users defined you can now enable authentication on the Couchbase Lite replicator. The code below creates two replications with authentication.</p>

<p><block class="ios" /></p>
<div class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="c1">// This code can be found in AppDelegate.swift</span>
<span class="c1">// in the startReplication(withUsername:andPassword:) method</span>
<span class="n">pusher</span> <span class="o">=</span> <span class="n">database</span><span class="o">.</span><span class="nf">createPushReplication</span><span class="p">(</span><span class="n">kSyncGatewayUrl</span><span class="p">)</span>
<span class="n">pusher</span><span class="o">.</span><span class="n">continuous</span> <span class="o">=</span> <span class="kc">true</span>
<span class="kt">NotificationCenter</span><span class="o">.</span><span class="k">default</span><span class="o">.</span><span class="nf">addObserver</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="nv">selector</span><span class="p">:</span> <span class="kd">#selector(</span><span class="nf">replicationProgress(notification:)</span><span class="kd">)</span><span class="p">,</span>
    <span class="nv">name</span><span class="p">:</span> <span class="kt">NSNotification</span><span class="o">.</span><span class="kt">Name</span><span class="o">.</span><span class="n">cblReplicationChange</span><span class="p">,</span> <span class="nv">object</span><span class="p">:</span> <span class="n">pusher</span><span class="p">)</span>

<span class="n">puller</span> <span class="o">=</span> <span class="n">database</span><span class="o">.</span><span class="nf">createPullReplication</span><span class="p">(</span><span class="n">kSyncGatewayUrl</span><span class="p">)</span>
<span class="n">puller</span><span class="o">.</span><span class="n">continuous</span> <span class="o">=</span> <span class="kc">true</span>
<span class="kt">NotificationCenter</span><span class="o">.</span><span class="k">default</span><span class="o">.</span><span class="nf">addObserver</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="nv">selector</span><span class="p">:</span> <span class="kd">#selector(</span><span class="nf">replicationProgress(notification:)</span><span class="kd">)</span><span class="p">,</span>
                                        <span class="nv">name</span><span class="p">:</span> <span class="kt">NSNotification</span><span class="o">.</span><span class="kt">Name</span><span class="o">.</span><span class="n">cblReplicationChange</span><span class="p">,</span> <span class="nv">object</span><span class="p">:</span> <span class="n">puller</span><span class="p">)</span>

<span class="k">if</span> <span class="n">kLoginFlowEnabled</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">authenticator</span> <span class="o">=</span> <span class="kt">CBLAuthenticator</span><span class="o">.</span><span class="nf">basicAuthenticator</span><span class="p">(</span><span class="nv">withName</span><span class="p">:</span> <span class="n">username</span><span class="p">,</span> <span class="nv">password</span><span class="p">:</span> <span class="n">password</span><span class="o">!</span><span class="p">)</span>
    <span class="n">pusher</span><span class="o">.</span><span class="n">authenticator</span> <span class="o">=</span> <span class="n">authenticator</span>
    <span class="n">puller</span><span class="o">.</span><span class="n">authenticator</span> <span class="o">=</span> <span class="n">authenticator</span>
<span class="p">}</span>

<span class="n">pusher</span><span class="o">.</span><span class="nf">start</span><span class="p">()</span>
<span class="n">puller</span><span class="o">.</span><span class="nf">start</span><span class="p">()</span>
</code></pre></div>
<p><block class="net" /></p>
<div class="highlight"><pre><code class="language-c#" data-lang="c#"><span class="c1">// This code can be found in CoreApp.cs</span>
<span class="c1">// in the StartReplication(string, string) method</span>
<span class="kt">var</span> <span class="n">authenticator</span> <span class="p">=</span> <span class="k">default</span><span class="p">(</span><span class="n">IAuthenticator</span><span class="p">);</span>
<span class="k">if</span><span class="p">(</span><span class="n">username</span> <span class="p">!=</span> <span class="k">null</span> <span class="p">&amp;&amp;</span> <span class="n">password</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">authenticator</span> <span class="p">=</span> <span class="n">AuthenticatorFactory</span><span class="p">.</span><span class="nf">CreateBasicAuthenticator</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">var</span> <span class="n">db</span> <span class="p">=</span> <span class="n">AppWideManager</span><span class="p">.</span><span class="nf">GetDatabase</span><span class="p">(</span><span class="n">username</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">pusher</span> <span class="p">=</span> <span class="n">db</span><span class="p">.</span><span class="nf">CreatePushReplication</span><span class="p">(</span><span class="n">SyncGatewayUrl</span><span class="p">);</span>
<span class="n">pusher</span><span class="p">.</span><span class="n">Continuous</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
<span class="n">pusher</span><span class="p">.</span><span class="n">Authenticator</span> <span class="p">=</span> <span class="n">authenticator</span><span class="p">;</span>


<span class="kt">var</span> <span class="n">puller</span> <span class="p">=</span> <span class="n">db</span><span class="p">.</span><span class="nf">CreatePullReplication</span><span class="p">(</span><span class="n">SyncGatewayUrl</span><span class="p">);</span>
<span class="n">puller</span><span class="p">.</span><span class="n">Continuous</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
<span class="n">puller</span><span class="p">.</span><span class="n">Authenticator</span> <span class="p">=</span> <span class="n">authenticator</span><span class="p">;</span>

<span class="n">pusher</span><span class="p">.</span><span class="nf">Start</span><span class="p">();</span>
<span class="n">puller</span><span class="p">.</span><span class="nf">Start</span><span class="p">();</span>

<span class="n">_pusher</span> <span class="p">=</span> <span class="n">pusher</span><span class="p">;</span>
<span class="n">_puller</span> <span class="p">=</span> <span class="n">puller</span><span class="p">;</span>
</code></pre></div>
<p><block class="android" /></p>
<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">URL</span> <span class="n">url</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
<span class="k">try</span> <span class="o">{</span>
    <span class="n">url</span> <span class="o">=</span> <span class="k">new</span> <span class="n">URL</span><span class="o">(</span><span class="n">mSyncGatewayUrl</span><span class="o">);</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">MalformedURLException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
<span class="o">}</span>

<span class="n">pusher</span> <span class="o">=</span> <span class="n">database</span><span class="o">.</span><span class="na">createPushReplication</span><span class="o">(</span><span class="n">url</span><span class="o">);</span>
<span class="n">pusher</span><span class="o">.</span><span class="na">setContinuous</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>

<span class="n">puller</span> <span class="o">=</span> <span class="n">database</span><span class="o">.</span><span class="na">createPullReplication</span><span class="o">(</span><span class="n">url</span><span class="o">);</span>
<span class="n">puller</span><span class="o">.</span><span class="na">setContinuous</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>

<span class="k">if</span> <span class="o">(</span><span class="n">mLoginFlowEnabled</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">Authenticator</span> <span class="n">authenticator</span> <span class="o">=</span> <span class="n">AuthenticatorFactory</span><span class="o">.</span><span class="na">createBasicAuthenticator</span><span class="o">(</span><span class="n">username</span><span class="o">,</span> <span class="n">password</span><span class="o">);</span>
    <span class="n">pusher</span><span class="o">.</span><span class="na">setAuthenticator</span><span class="o">(</span><span class="n">authenticator</span><span class="o">);</span>
    <span class="n">puller</span><span class="o">.</span><span class="na">setAuthenticator</span><span class="o">(</span><span class="n">authenticator</span><span class="o">);</span>
<span class="o">}</span>

<span class="n">pusher</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
<span class="n">puller</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
</code></pre></div>
<p><block class="all" /></p>

<p>The <code>CBLAuthenticator</code> class has static methods for each authentication method supported by Couchbase Lite. Here, you&#39;re passing the name/password to the <code>basicAuthenticatorWithName</code> method. The object returned by this method can be set on the replication&#39;s <code>authenticator</code> property.</p>
<h4><a class="anchor instructions" name="try-it-out"></a>Try it out<a class="hash-link instructions" href="#try-it-out"><svg aria-hidden="true" class="octicon octicon-link" height="20" version="1.1" viewBox="0 -3 20 20" width="20"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a></h4>
<p><block class="ios" /></p>

<ol>
<li><p>Set <code>kSyncEnabled</code> and <code>kLoginFlowEnabled</code> to <code>true</code> in <strong>AppDelegate.swift</strong>.</p>
<div class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="k">let</span> <span class="nv">kSyncEnabled</span> <span class="o">=</span> <span class="kc">true</span>
<span class="k">let</span> <span class="nv">kLoginFlowEnabled</span> <span class="o">=</span> <span class="kc">true</span>
</code></pre></div></li>
<li><p>Build and run.</p></li>
<li><p>Now login with the credentials saved in the config file previously (<strong>user1/pass</strong>) and create a new list. Open the Sync Gateway Admin UI at <a href="http://localhost:4985/_admin/db/todo">http://localhost:4985/_admin/db/todo</a>, the list document is successfully replicated to Sync Gateway as an authenticated user.</p></li>
</ol>

<div class="experimental-label">
  <span>Experimental</span>
  <br>
  <em>Experimental features may have bugs since they are not certified by Couchbase QE. Couchbase may drop the feature all together or create a brand new component with equivalent functionality in new releases.</em>
</div>

<style>
  @media screen and (min-width: 800px) {
    .experimental-label {
      position: absolute;
      left: -150px;
      width: 170px;
    }
    .experimental-label span {
      color: #d43900;
      border-color: #d43900;
      font-size: 12px;
      padding: 1px 10px;
      border: 1px solid #e85d00;
      border-radius: 3px;
    }
    .experimental-label em {
      font-size: 13px;
    }
  }

  @media screen and (max-width: 800px) {
    .experimental-label {
      display: none;
    }
  }
</style>

<p><img src="img/image35.png" class=center-image /></p>

<p><block class="net" /></p>

<ol>
<li><p>Change <code>LoginEnabled = false</code> to <code>LoginEnabled = true</code> in the <code>CreateHint()</code> method in <strong>CoreApp.cs</strong></p>
<div class="highlight"><pre><code class="language-c#" data-lang="c#"><span class="kt">var</span> <span class="n">retVal</span> <span class="p">=</span> <span class="k">new</span> <span class="n">CoreAppStartHint</span> <span class="p">{</span>
    <span class="n">LoginEnabled</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span> <span class="c1">// Line to change is here</span>
    <span class="n">EncryptionEnabled</span> <span class="p">=</span> <span class="k">false</span><span class="p">,</span>
    <span class="n">SyncEnabled</span> <span class="p">=</span> <span class="k">false</span><span class="p">,</span>
    <span class="n">UsePrebuiltDB</span> <span class="p">=</span> <span class="k">false</span><span class="p">,</span>
    <span class="n">ConflictResolution</span> <span class="p">=</span> <span class="k">false</span><span class="p">,</span>
    <span class="n">Username</span> <span class="p">=</span> <span class="s">"todo"</span>
<span class="p">};</span>

<span class="k">return</span> <span class="n">retVal</span><span class="p">;</span>
</code></pre></div></li>
<li><p>Build and run.</p></li>
<li><p>Now login with the credentials saved in the config file previously (<strong>user1/pass</strong>) and create a new list. Open the Sync Gateway Admin UI at <a href="http://localhost:4985/_admin/db/todo">http://localhost:4985/_admin/db/todo</a>, the list document is successfully replicated to Sync Gateway as an authenticated user.</p></li>
</ol>

<p><block class="wpf" /></p>

<div class="experimental-label">
  <span>Experimental</span>
  <br>
  <em>Experimental features may have bugs since they are not certified by Couchbase QE. Couchbase may drop the feature all together or create a brand new component with equivalent functionality in new releases.</em>
</div>

<style>
  @media screen and (min-width: 800px) {
    .experimental-label {
      position: absolute;
      left: -150px;
      width: 170px;
    }
    .experimental-label span {
      color: #d43900;
      border-color: #d43900;
      font-size: 12px;
      padding: 1px 10px;
      border: 1px solid #e85d00;
      border-radius: 3px;
    }
    .experimental-label em {
      font-size: 13px;
    }
  }

  @media screen and (max-width: 800px) {
    .experimental-label {
      display: none;
    }
  }
</style>

<p><img src="img/image35w.png" class=center-image /></p>

<p><block class="android" /></p>

<ol>
<li><p>Set <code>mSyncEnabled</code> and <code>mLoginFlowEnabled</code> to <code>true</code> in <strong>Application.java</strong>.</p>
<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">private</span> <span class="n">Boolean</span> <span class="n">mSyncEnabled</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
<span class="kd">private</span> <span class="n">Boolean</span> <span class="n">mLoginFlowEnabled</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
</code></pre></div></li>
<li><p>Build and run.</p></li>
<li><p>Now login with the credentials saved in the config file previously (<strong>user1/pass</strong>) and create a new list. Open the Sync Gateway Admin UI at <a href="http://localhost:4985/_admin/db/todo">http://localhost:4985/_admin/db/todo</a>, the list document is successfully replicated to Sync Gateway as an authenticated user.</p></li>
</ol>

<div class="experimental-label">
  <span>Experimental</span>
  <br>
  <em>Experimental features may have bugs since they are not certified by Couchbase QE. Couchbase may drop the feature all together or create a brand new component with equivalent functionality in new releases.</em>
</div>

<style>
  @media screen and (min-width: 800px) {
    .experimental-label {
      position: absolute;
      left: -150px;
      width: 170px;
    }
    .experimental-label span {
      color: #d43900;
      border-color: #d43900;
      font-size: 12px;
      padding: 1px 10px;
      border: 1px solid #e85d00;
      border-radius: 3px;
    }
    .experimental-label em {
      font-size: 13px;
    }
  }

  @media screen and (max-width: 800px) {
    .experimental-label {
      display: none;
    }
  }
</style>

<p><img src="img/image35a.png" class=center-image /></p>

<p><block class="wpf" /></p>

<blockquote>
<p><strong>Note:</strong> You can remove the local database and check if the pull replication retrieves the documents now present on Sync Gateway. Using File Explorer, type <code>%LOCALAPPDATA%</code> into the location bar and press enter, then delete the database <strong>user1.cblite2</strong>. Then restart the app and you&#39;ll notice that the &quot;Today&quot; list isn&#39;t displayed. That is, the list document wasn&#39;t replicated from Sync Gateway to Couchbase Lite. Indeed, the document is not routed to a channel that the user has access to. <strong>Channel</strong> and <strong>access</strong> are new terms so don&#39;t worry, we&#39;ll cover what they mean in the next section.</p>
</blockquote>

<p><block class="xam" /></p>

<blockquote>
<p><strong>Note:</strong> You can remove the local database and check if the pull replication retrieves the documents now present on Sync Gateway. On macOS, use the <a href="https://simpholders.com/">SimPholders</a> utility app to quickly find the data directory of the application and delete the database called <strong>user1</strong> on iOS, or you can use the adb shell to navigate to the application&#39;s data folder and delete it on Android. Then restart the app and you&#39;ll notice that the &quot;Today&quot; list isn&#39;t displayed. That is, the list document wasn&#39;t replicated from Sync Gateway to Couchbase Lite. Indeed, the document is not routed to a channel that the user has access to. <strong>Channel</strong> and <strong>access</strong> are new terms so don&#39;t worry, we&#39;ll cover what they mean in the next section.</p>
</blockquote>

<p><block class="all" /></p>
<h2><a class="anchor instructions" name="access-control"></a>Access Control<a class="hash-link instructions" href="#access-control"><svg aria-hidden="true" class="octicon octicon-link" height="20" version="1.1" viewBox="0 -3 20 20" width="20"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a></h2>
<p>In order to give different users access to different documents, you must write a sync function. The sync function lives in the configuration file of Sync Gateway. It’s a JavaScript function and every time a new document, revision or deletion is added to a database, the sync function is called and given a chance to examine the document.</p>

<p>You can use different API methods to route documents to channels, grant users access to channels and even assign roles to users. Access rules generally follow the order shown on the image below: write permissions, validation, routing, read permissions.</p>

<p><img src="img/image15.png" alt=""></p>

<blockquote>
<p><strong>Tip:</strong> Open the <a href="/documentation/mobile/current/training/design/security/index.html">Access Control</a> lesson in a new tab, it will be useful throughout this section.</p>
</blockquote>
<h3><a class="anchor instructions" name="document-types"></a>Document Types<a class="hash-link instructions" href="#document-types"><svg aria-hidden="true" class="octicon octicon-link" height="20" version="1.1" viewBox="0 -3 20 20" width="20"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a></h3>
<p>The Sync Function takes two arguments:</p>

<ul>
<li><strong>doc:</strong> The current revision being processed.</li>
<li><strong>oldDoc:</strong> The parent revisions if it&#39;s an update operation and <code>null</code> if it&#39;s a create operation.</li>
</ul>

<p>Each document type will have different access control rules associated with it. So the first operation is to ensure the document has a type property. Additionally, once a document is created, its type cannot change. The code below implements those 2 validation rules.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span><span class="p">(</span><span class="nx">doc</span><span class="p">,</span> <span class="nx">oldDoc</span><span class="p">){</span>
  <span class="cm">/* Type validation */</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">isCreate</span><span class="p">())</span> <span class="p">{</span>
    <span class="c1">// Don't allow creating a document without a type.</span>
    <span class="nx">validateNotEmpty</span><span class="p">(</span><span class="s2">"type"</span><span class="p">,</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">type</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">isUpdate</span><span class="p">())</span> <span class="p">{</span>
    <span class="c1">// Don't allow changing the type of any document.</span>
    <span class="nx">validateReadOnly</span><span class="p">(</span><span class="s2">"type"</span><span class="p">,</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">type</span><span class="p">,</span> <span class="nx">oldDoc</span><span class="p">.</span><span class="nx">type</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">getType</span><span class="p">()</span> <span class="o">==</span> <span class="s2">"task-list"</span><span class="p">)</span> <span class="p">{</span>
    <span class="cm">/* Write access */</span>
    <span class="cm">/* Validation */</span>
    <span class="cm">/* Routing */</span>
    <span class="cm">/* Read Access */</span>
  <span class="p">}</span>

  <span class="kd">function</span> <span class="nx">getType</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="nx">isDelete</span><span class="p">()</span> <span class="p">?</span> <span class="nx">oldDoc</span><span class="p">.</span><span class="nx">type</span> <span class="p">:</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">type</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="kd">function</span> <span class="nx">isCreate</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Checking false for the Admin UI to work</span>
    <span class="k">return</span> <span class="p">((</span><span class="nx">oldDoc</span> <span class="o">==</span> <span class="kc">false</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="nx">oldDoc</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="nx">oldDoc</span><span class="p">.</span><span class="nx">_deleted</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">isDelete</span><span class="p">());</span>
  <span class="p">}</span>

  <span class="kd">function</span> <span class="nx">isUpdate</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="o">!</span><span class="nx">isCreate</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">isDelete</span><span class="p">());</span>
  <span class="p">}</span>

  <span class="kd">function</span> <span class="nx">isDelete</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="nx">doc</span><span class="p">.</span><span class="nx">_deleted</span> <span class="o">==</span> <span class="kc">true</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="kd">function</span> <span class="nx">validateNotEmpty</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">throw</span><span class="p">({</span><span class="na">forbidden</span><span class="p">:</span> <span class="nx">key</span> <span class="o">+</span> <span class="s2">" is not provided."</span><span class="p">});</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="kd">function</span> <span class="nx">validateReadOnly</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">oldValue</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">value</span> <span class="o">!=</span> <span class="nx">oldValue</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">throw</span><span class="p">({</span><span class="na">forbidden</span><span class="p">:</span> <span class="nx">name</span> <span class="o">+</span> <span class="s2">" is read-only."</span><span class="p">});</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="c1">// Checks whether the provided value starts with the specified prefix</span>
  <span class="kd">function</span> <span class="nx">hasPrefix</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">prefix</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">value</span> <span class="o">&amp;&amp;</span> <span class="nx">prefix</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">value</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">prefix</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="o">==</span> <span class="nx">prefix</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kc">false</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>As shown above, you can define inner functions to encapsulate logic used throughout the sync function. This makes your code more readable and follows the DRY principle (Don&#39;t Repeat Yourself).</p>
<h4><a class="anchor instructions" name="try-it-out"></a>Try it out<a class="hash-link instructions" href="#try-it-out"><svg aria-hidden="true" class="octicon octicon-link" height="20" version="1.1" viewBox="0 -3 20 20" width="20"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a></h4>
<ol>
<li>Open the Sync menu on the Admin UI <a href="http://localhost:4985/_admin/db/todo/sync">http://localhost:4985/_admin/db/todo/sync</a>.</li>
<li>Copy the code snippet above in the Sync Function text area.</li>
<li>Click the <strong>Deploy To Server</strong> button. It will update Sync Gateway with the new config but it doesn&#39;t persist the changes to the filesystem.</li>
<li><p>Add two documents through the REST API. One with the <code>type</code> property and the second document without it. Notice that the user credentials (<strong>user1/pass</strong>) are passed in the URL.</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">curl <span class="nt">-vX</span> POST <span class="s1">'http://user1:pass@localhost:4984/todo/_bulk_docs'</span> <span class="se">\</span>
      <span class="nt">-H</span> <span class="s1">'Content-Type: application/json'</span> <span class="se">\</span>
      <span class="nt">-d</span> <span class="s1">'{"docs": [{"type": "task-list", "name": "Groceries"}, {"names": "Today"}]}'</span>
</code></pre></div>
<p>The output should be the following:</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="o">[</span>
  <span class="o">{</span><span class="s2">"id"</span>:<span class="s2">"e498cad0380e30a86ed5572140c94831"</span>,<span class="s2">"rev"</span>:<span class="s2">"1-e4ac377fc9bd3345ddf5892b509c4d79"</span><span class="o">}</span>,
  <span class="o">{</span><span class="s2">"error"</span>:<span class="s2">"forbidden"</span>,<span class="s2">"reason"</span>:<span class="s2">"type is not provided."</span>,<span class="s2">"status"</span>:403<span class="o">}</span>
<span class="o">]</span>
</code></pre></div>
<blockquote>
<p><strong>Note:</strong> The curl executable for Windows can be found <a href="https://curl.haxx.se/download.html">on this page</a></p>
</blockquote>

<p>The document without a type is rejected with an error message: &quot;type property missing&quot;.</p></li>
</ol>
<h3><a class="anchor instructions" name="write-permissions"></a>Write Permissions<a class="hash-link instructions" href="#write-permissions"><svg aria-hidden="true" class="octicon octicon-link" height="20" version="1.1" viewBox="0 -3 20 20" width="20"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a></h3>
<p>Once you know the type of a document, the next step is to check the write permissions.</p>

<p>The following code ensures the user creating the list document matches with the <code>owner</code> property or is a moderator.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="cm">/* Write Access */</span>
<span class="kd">var</span> <span class="nx">owner</span> <span class="o">=</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">_deleted</span> <span class="p">?</span> <span class="nx">oldDoc</span><span class="p">.</span><span class="nx">owner</span> <span class="p">:</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">owner</span><span class="p">;</span>
<span class="k">try</span> <span class="p">{</span>
  <span class="c1">// Moderators can create/update lists for other users.</span>
  <span class="nx">requireRole</span><span class="p">(</span><span class="s2">"moderator"</span><span class="p">);</span>
<span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// Users can create/update lists for themselves.</span>
  <span class="nx">requireUser</span><span class="p">(</span><span class="nx">owner</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>When a document is deleted the user properties are removed and the <code>_deleted: true</code> property is added as metadata. In this case, the sync function must retrieve the type from oldDoc. In the code above, the <code>getType</code> inner function encapsulates this logic.</p>

<p>Similarly, the owner field is taken from oldDoc if doc is a deletion revision. The <code>requireUser</code> and <code>requireRole</code> functions are functionalities built in Sync Gateway.</p>
<h4><a class="anchor instructions" name="try-it-out"></a>Try it out<a class="hash-link instructions" href="#try-it-out"><svg aria-hidden="true" class="octicon octicon-link" height="20" version="1.1" viewBox="0 -3 20 20" width="20"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a></h4>
<ol>
<li>Open the Sync menu on the Admin UI <a href="http://localhost:4985/_admin/db/todo/sync">http://localhost:4985/_admin/db/todo/sync</a>.</li>
<li>Copy the changes above in the Sync Function text area to replace the <code>/* Write access */</code> block.</li>
<li>Click the <strong>Deploy To Server</strong> button. It will update Sync Gateway with the new config but it doesn&#39;t persist the changes to the filesystem.</li>
<li><p>Add two documents through the REST API. The request is sent as a user (<strong>user1/pass</strong>). One document is a list for user1 and another is a list for user2.</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">curl <span class="nt">-vX</span> POST <span class="s1">'http://user1:pass@localhost:4984/todo/_bulk_docs'</span> <span class="se">\</span>
      <span class="nt">-H</span> <span class="s1">'Content-Type: application/json'</span> <span class="se">\</span>
      <span class="nt">-d</span> <span class="s1">'{"docs": [{"type": "task-list", "owner": "user1"}, {"type": "task-list", "owner": "user2"}]}'</span>
</code></pre></div>
<p>The response should be the following:</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="o">[</span>
  <span class="o">{</span><span class="s2">"id"</span>:<span class="s2">"8339356c8bb6d8b32477e931ce04c5c9"</span>,<span class="s2">"rev"</span>:<span class="s2">"1-39539a8ec6ddd252d6aafe1f7e3efd9a"</span><span class="o">}</span>,
  <span class="o">{</span><span class="s2">"error"</span>:<span class="s2">"forbidden"</span>,<span class="s2">"reason"</span>:<span class="s2">"wrong user"</span>,<span class="s2">"status"</span>:403<span class="o">}</span>
<span class="o">]</span>
</code></pre></div>
<p>The list with user2 as the owner is rejected.</p></li>
</ol>
<h3><a class="anchor instructions" name="validation"></a>Validation<a class="hash-link instructions" href="#validation"><svg aria-hidden="true" class="octicon octicon-link" height="20" version="1.1" viewBox="0 -3 20 20" width="20"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a></h3>
<p>After write permissions, you must ensure the document has the expected schema. There are different types of validation such as checking for the presence of a field or enforcing read-only permission on parts of a document. The code below performs various schema validation operations.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="cm">/* Validation */</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">isDelete</span><span class="p">())</span> <span class="p">{</span>
  <span class="c1">// Validate required fields.</span>
  <span class="nx">validateNotEmpty</span><span class="p">(</span><span class="s2">"name"</span><span class="p">,</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
  <span class="nx">validateNotEmpty</span><span class="p">(</span><span class="s2">"owner"</span><span class="p">,</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">owner</span><span class="p">);</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">isCreate</span><span class="p">())</span> <span class="p">{</span>
    <span class="c1">// Validate that the _id is prefixed by owner.</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">hasPrefix</span><span class="p">(</span><span class="nx">doc</span><span class="p">.</span><span class="nx">_id</span><span class="p">,</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">owner</span> <span class="o">+</span> <span class="s2">"."</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">throw</span><span class="p">({</span><span class="na">forbidden</span><span class="p">:</span> <span class="s2">"task-list id must be prefixed by list owner"</span><span class="p">});</span>
    <span class="p">}</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// Don’t allow task-list ownership to be changed.</span>
    <span class="nx">validateReadOnly</span><span class="p">(</span><span class="s2">"owner"</span><span class="p">,</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">owner</span><span class="p">,</span> <span class="nx">oldDoc</span><span class="p">.</span><span class="nx">owner</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p><code>validateNotEmpty</code> and <code>validateReadOnly</code> are inner functions to encapsulate common validation operations.</p>
<h4><a class="anchor instructions" name="try-it-out"></a>Try it out<a class="hash-link instructions" href="#try-it-out"><svg aria-hidden="true" class="octicon octicon-link" height="20" version="1.1" viewBox="0 -3 20 20" width="20"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a></h4>
<ol>
<li>Open the Sync menu on the Admin UI <a href="http://localhost:4985/_admin/db/todo/sync">http://localhost:4985/_admin/db/todo/sync</a>.</li>
<li>Copy the changes above in the Sync Function text area to replace the <code>/* Validation */</code> block.</li>
<li>Click the <strong>Deploy To Server</strong> button. It will update Sync Gateway with the new config but it doesn&#39;t persist the changes to the filesystem.</li>
</ol>

<blockquote>
<p><strong>Challenge:</strong> Persist documents using curl until it gets persisted and Sync Gateway returns a <strong>201 Created</strong> status code.</p>
</blockquote>
<h3><a class="anchor instructions" name="routing"></a>Routing<a class="hash-link instructions" href="#routing"><svg aria-hidden="true" class="octicon octicon-link" height="20" version="1.1" viewBox="0 -3 20 20" width="20"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a></h3>
<p>Once you have determined that the schema is valid you can route the document to channels. A channel is a namespace for documents specifically designed for access control. The code below routes the document to its own list channel.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="cm">/* Routing */</span>
<span class="c1">// Add doc to task-list's channel.</span>
<span class="nx">channel</span><span class="p">(</span><span class="s2">"task-list."</span> <span class="o">+</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">_id</span><span class="p">);</span>
<span class="nx">channel</span><span class="p">(</span><span class="s2">"moderators"</span><span class="p">);</span>
</code></pre></div><h4><a class="anchor instructions" name="try-it-out"></a>Try it out<a class="hash-link instructions" href="#try-it-out"><svg aria-hidden="true" class="octicon octicon-link" height="20" version="1.1" viewBox="0 -3 20 20" width="20"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a></h4>
<ol>
<li>Open the Sync menu on the Admin UI <a href="http://localhost:4985/_admin/db/todo/sync">http://localhost:4985/_admin/db/todo/sync</a>.</li>
<li>Copy the changes above in the Sync Function text area to replace the <code>/* Routing */</code> block.</li>
<li>Click the <strong>Live Preview Mode</strong> button. This mode doesn&#39;t restart Sync Gateway but will use the updated Sync Function for testing purposes. Click the <strong>random</strong> button to pick a document at random and run it through the sync function again. It re-calculates the routing to channels and access grants. This time, the owner (user1) has access to its own list&#39;s channel.</li>
<li><p>Both documents are saved and mapped to the corresponding channels in the Admin UI.</p>

<p><img src="img/image88.png" alt=""></p></li>
</ol>
<h3><a class="anchor instructions" name="read-access"></a>Read Access<a class="hash-link instructions" href="#read-access"><svg aria-hidden="true" class="octicon octicon-link" height="20" version="1.1" viewBox="0 -3 20 20" width="20"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a></h3>
<p>The last step in writing access control rules for a document type is to allow read access to channels. The following code grants the owner and users that are moderators access to the list&#39;s channel.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="cm">/* Read Access */</span>
<span class="c1">// Grant task-list owner access to the task-list, its tasks, and its users.</span>
<span class="nx">access</span><span class="p">(</span><span class="nx">owner</span><span class="p">,</span> <span class="s2">"task-list."</span> <span class="o">+</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">_id</span><span class="p">);</span>
<span class="nx">access</span><span class="p">(</span><span class="nx">owner</span><span class="p">,</span> <span class="s2">"task-list."</span> <span class="o">+</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">_id</span> <span class="o">+</span> <span class="s2">".users"</span><span class="p">);</span>
<span class="nx">access</span><span class="p">(</span><span class="s2">"role:moderator"</span><span class="p">,</span> <span class="s2">"task-list."</span> <span class="o">+</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">_id</span><span class="p">);</span>
</code></pre></div><h4><a class="anchor instructions" name="try-it-out"></a>Try it out<a class="hash-link instructions" href="#try-it-out"><svg aria-hidden="true" class="octicon octicon-link" height="20" version="1.1" viewBox="0 -3 20 20" width="20"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a></h4>
<ol>
<li>Open the Sync menu on the Admin UI <a href="http://localhost:4985/_admin/db/todo/sync">http://localhost:4985/_admin/db/todo/sync</a>.</li>
<li>Copy the changes above in the Sync Function text area to replace the <code>/* Read access */</code> block.</li>
<li><p>Click the <strong>Live Preview Mode</strong> button. This mode doesn&#39;t restart Sync Gateway but will use the updated Sync Function for testing purposes. Click the <strong>random</strong> button to pick a document at random and run it through the sync function again. It re-calculates the routing to channels and access grants. This time, the owner (user1) has access to its own list&#39;s channel.</p>

<p><img src="img/image38.png" alt=""></p></li>
</ol>
<h2><a class="anchor instructions" name="conclusion"></a>Conclusion<a class="hash-link instructions" href="#conclusion"><svg aria-hidden="true" class="octicon octicon-link" height="20" version="1.1" viewBox="0 -3 20 20" width="20"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a></h2>
<p>Well done! You&#39;ve completed this lesson on adding authentication, writing a sync function and adding database encryption. Feel free to share your feedback, findings or ask any questions on the forums.</p>

                <!-- Logic to make all links open in a new tab -->
                <script>
                  var links = document.links;

                  for (var i = 0, linksLength = links.length; i < linksLength; i++) {
                    if (['button-swift', 'button-objc', 'button-csharp', 'button-java', 'button-ios', 'button-android', 'button-wpf'].indexOf(links[i].className) == -1) {
                      if (links[i].hostname != window.location.hostname) {
                        links[i].target = '_blank';
                      }
                    }
                  }
                </script>
                <!-- Logic for platform tabs -->
                <script>
                  // Only show on Develop pages
                  var blocksv1 = document.getElementsByClassName('ios');
                  var blocksv2 = document.getElementsByClassName('swift');
                  if ((blocksv1.length > 0 && blocksv1[0].tagName == 'BLOCK') || (blocksv2.length > 0 && blocksv2[0].tagName == 'BLOCK')) {
                    var platformTabs = document.getElementById('platform-tabs');
                    platformTabs.className = "show";
                  }
                  // Convert <div>...<span><block /></span>...</div>
                  // Into <div>...<block />...</div>
                  var blocks = document.getElementsByTagName('block');
                  for (var i = 0; i < blocks.length; ++i) {
                    // Ignore blocks that have the inline class name.
                    if (blocks[i].className.indexOf('inline') == -1) {
                      var block = blocks[i];
                      var span = blocks[i].parentNode;
                      var container = span.parentNode;
                      container.insertBefore(block, span);
                      container.removeChild(span);
                    }
                  }
                  // Convert <div>...<block />content<block />...</div>
                  // Into <div>...<block>content</block><block />...</div>
                  blocks = document.getElementsByTagName('block');
                  for (var i = 0; i < blocks.length; ++i) {
                    // Ignore blocks that have the inline class name.
                    if (blocks[i].className.indexOf('inline') == -1) {
                      var block = blocks[i];
                      while (block.nextSibling && block.nextSibling.tagName !== 'BLOCK') {
                        block.appendChild(block.nextSibling);
                      }
                    }
                  }
                  function display(type, value, isFirstPageLoad) {
                    deleteCookie('mobile-lang');
                    setCookie('mobile-lang', value, 365);
                    if (!isFirstPageLoad) {
                      var newurl = UpdateQueryString('language', value);
                      window.history.pushState({path: newurl}, '', newurl);
                    }
                    // Place the display-platform-* class on div.inner-content
                    var container = document.getElementsByClassName('inner-content')[0];
                    container.className = 'inner-content display-' + type + '-' + value;
                    if (value == 'wpf' || value == 'csharp' || value == 'xam') {
                      container.className += ' display-platform-net';
                    }
                    container.className += ' display-platform-all';
                    return false;
                  }

                  // If we are coming to the page with a hash in it (i.e. from a search, for example), try to get
                  // us as close as possible to the correct platform and dev os using the hashtag and block walk up.
                  var foundHash = false;
                  var language = getParameterByName('language');
                  if (['ios', 'android', 'csharp', 'swift', 'objc', 'wpf', 'java'].indexOf(language) > -1) {
                    foundHash = true;
                    display('platform', language, true);
                  }

                  if (!foundHash) {
                    var cookie_lang = getCookie('mobile-lang');
                    if (document.getElementsByClassName(cookie_lang).length > 0) {
                      display('platform', cookie_lang, true);
                    } else {
                      if (document.getElementsByClassName('swift').length > 0) {
                        display('platform', 'swift', true);
                      } else if (document.getElementsByClassName('ios').length > 0) {
                        display('platform', 'ios', true);
                      }
                    }
                  }

                  function getParameterByName(name, url) {
                    if (!url) {
                      url = window.location.href;
                    }
                    name = name.replace(/[\[\]]/g, "\\$&");
                    var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
                      results = regex.exec(url);
                    if (!results) return null;
                    if (!results[2]) return '';
                    return decodeURIComponent(results[2].replace(/\+/g, " "));
                  }
                  function setCookie(cname, cvalue, exdays) {
                    var d = new Date();
                    d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));
                    var expires = "expires="+d.toUTCString();
                    document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
                  }
                  function deleteCookie(cname) {
                    document.cookie = cname + '=; expires=Thu, 01 Jan 1970 00:00:01 GMT;';
                  }
                  function getCookie(cname) {
                    var name = cname + "=";
                    var decodedCookie = decodeURIComponent(document.cookie);
                    var ca = decodedCookie.split(';');
                    for(var i = 0; i <ca.length; i++) {
                      var c = ca[i];
                      while (c.charAt(0) == ' ') {
                        c = c.substring(1);
                      }
                      if (c.indexOf(name) == 0) {
                        return c.substring(name.length, c.length);
                      }
                    }
                    return "";
                  }
                  function UpdateQueryString(key, value, url) {
                    if (!url) url = window.location.href;
                    var re = new RegExp("([?&])" + key + "=.*?(&|#|$)(.*)", "gi"),
                      hash;

                    if (re.test(url)) {
                      if (typeof value !== 'undefined' && value !== null)
                        return url.replace(re, '$1' + key + "=" + value + '$2$3');
                      else {
                        hash = url.split('#');
                        url = hash[0].replace(re, '$1$3').replace(/(&|\?)$/, '');
                        if (typeof hash[1] !== 'undefined' && hash[1] !== null)
                          url += '#' + hash[1];
                        return url;
                      }
                    }
                    else {
                      if (typeof value !== 'undefined' && value !== null) {
                        var separator = url.indexOf('?') !== -1 ? '&' : '?';
                        hash = url.split('#');
                        url = hash[0] + separator + key + '=' + value;
                        if (typeof hash[1] !== 'undefined' && hash[1] !== null)
                          url += '#' + hash[1];
                        return url;
                      }
                      else
                        return url;
                    }
                  }
                </script>
                <!-- Segment.io analytics -->
                <script type="text/javascript">
                  !function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","page","once","off","on"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t){var e=document.createElement("script");e.type="text/javascript";e.async=!0;e.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)};analytics.SNIPPET_VERSION="3.1.0";
                    analytics.load("8mPwsJfsKAal6r62qS9ubBQqjWwYly4M");
                    analytics.page()
                  }}();
                </script>
                <script>
                  var starterProject = document.getElementById('project');
                  analytics.trackLink(starterProject, 'Download project', {
                    category: 'Training',
                    label: 'Swift'
                  });
                </script>
                <!-- SDK buttons (shown only if show_true=true in the SDK) -->
                <script src="https://cdnjs.cloudflare.com/ajax/libs/fetch/1.0.0/fetch.min.js"></script>
                <script>

                  if (getParameterByName("show_swagger_libs") || getParameterByName("swagger")) {
                    var swagger_libs_el = document.getElementById('swagger-libs');
                    swagger_libs_el.style.display = 'block';
                  }

                  function getSDK(lang, spec) {
                    var url = null;
                    switch(spec) {
                      case 'public':
                        url = 'http://developer.couchbase.com/mobile/swagger/sync-gateway-public/spec.json';
                        break;
                      case 'admin':
                        url = 'http://developer.couchbase.com/mobile/swagger/sync-gateway-admin/spec.json';
                        break;
                      case 'lite':
                        url = 'http://developer.couchbase.com/mobile/swagger/couchbase-lite/spec.json';
                        break;
                    }
                    fetch(url)
                      .then(function (res) {
                        return res.json();
                      })
                      .then(function (res) {
                        var options = {
                          method: 'POST',
                          headers: {
                            'Content-Type': 'application/json'
                          },
                          body: JSON.stringify({spec: res})
                        };
                        return fetch('http://generator.swagger.io/api/gen/clients/' + lang, options)
                      })
                      .then(function (res) {
                        return res.json();
                      })
                      .then(function (res) {
                        window.location = res.link;
                      });
                  }

                  function getParameterByName(name, url) {
                    if (!url) url = window.location.href;
                    name = name.replace(/[\[\]]/g, "\\$&");
                    var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
                      results = regex.exec(url);
                    if (!results) return null;
                    if (!results[2]) return '';
                    return decodeURIComponent(results[2].replace(/\+/g, " "));
                  }
                </script>
              </div>

              <script>
                /**
                 * HACK: To keep the code tabs while using markdown. Insert <div class="tab"></div> in the markdown and this script
                 * finds and replaces all instances with a tab bar.
                 */
                var tab_bar_html = "</div><a href='javascript:setLanguage(\"swift\")' class=\"tab stripe-active swift\">Swift</a> <a href='javascript:setLanguage(\"objective-c\")' class=\"tab stripe-active objective-c selected\">Objective-C</a> <a href='javascript:setLanguage(\"android\")' class=\"tab stripe-active android\">Android</a> <a href='javascript:setLanguage(\"java\")' class=\"tab stripe-active java\">Java</a> <a href='javascript:setLanguage(\"c\")' class=\"tab stripe-active c\">C#</a>"
                var tab_bars = document.getElementsByClassName('tabs');
                var i = tab_bars.length - 1;
                while (i >= 0) {
                  var parent = tab_bars.item(i).parentNode;
                  var element = document.createElement('div');
                  element.className = 'tab-bar';
                  element.innerHTML = tab_bar_html;
                  parent.replaceChild(element, tab_bars.item(i));
                  i--;
                }

                /**
                 * HACK: To keep the markdown tables styles after ingestion we need to wrap the ouput in <div class="table"></div>
                 */
                var tables = document.getElementsByTagName("table");
                var j = tables.length - 1;
                while (j >= 0) {
                  var parent = tables.item(j).parentNode;
                  var table = tables.item(j);
                  var wrapper = document.createElement('div');
                  wrapper.className = 'table';
                  wrapper.style.padding = 0;
                  parent.insertBefore(wrapper, table);
                  wrapper.appendChild(table);
                  j--;
                }
              </script>
              <script>
                /**
                 * Hack to not open some list titles
                 */
                (function() {
                  var els = document.getElementsByClassName('static');
                  for (var i = 0; i < els.length; i++) {
                    (function() {
                      var el = els[i];
                      el.onclick = function () {
                        var icon = el.previousSibling;
                        var iconClasses = icon.className;
                        if (iconClasses == 'icon') {
                          icon.className = 'icon close';
                        } else {
                          icon.className = 'icon';
                        }
                        var list = el.nextSibling;
                        var displayProp = list.style.display;
                        if (displayProp == 'block') {
                          list.style.display = 'none';
                        } else {
                          list.style.display = 'block';
                        }
                      }
                    })()
                  }
                })()
              </script>
            </div>
          </div>
        </div>
      </div>
    </div>

  </section>
  
</main>
  </div>
</div>

<!-- Require_js bootstrap for app-specific JS module support -->
<!-- data-main attribute tells require.js to load
scripts/main.js after require.js loads. -->
<script type="text/javascript" src="https://developer.couchbase.com/webfiles/1498186094252/js/thirdparty/vendor/require.js"></script>
<script type="text/javascript" src="https://developer.couchbase.com/webfiles/1498186094252/js/thirdparty/vendor/prism.js"></script>
<script rel="main" type="text/javascript" src="https://developer.couchbase.com/webfiles/1498186094252/js/main.js" ></script>
<!-- leave the main attribute, it is used to help main.js determine -->
<!-- the domain-relative path to the base script (main.js) -->

</body>

</html>